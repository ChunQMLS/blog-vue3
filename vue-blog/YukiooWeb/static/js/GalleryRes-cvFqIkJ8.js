import{l as a}from"./element-plus-C50n0kKT.js";import{a as e}from"./galleryApi-iS1y8tOD.js";import{M as t}from"./Main-ndsmG3dN.js";import{d as l,F as s,r as i,s as r,w as o,h as u,A as m,o as n,c as p,K as v,a3 as d,T as h,D as c,B as g,ae as f,M as j,O as w,a as _,Q as y,J as x,U as b,u as k}from"./@vue-HJvXqiKQ.js";import{_ as R}from"./_plugin-vue_export-helper-NGi3vMWx.js";import{b as D}from"./vue-router-w7VblU2R.js";import{o as M}from"./config-p_8hFdbX.js";import"./dayjs-_EBtpdas.js";import"./copy-to-clipboard-6z1FYTZW.js";import"./toggle-selection-UL9rmEGR.js";import"./@element-plus-9anORygP.js";import"./@vueuse-f9VkAUex.js";import"./lodash-es-plMgWLWd.js";import"./@ctrl-s6KMGca5.js";import"./@popperjs-QJLSoJI5.js";import"./index-ex-BpVPP.js";import"./pinia-H_Pi8DHn.js";import"./@codemirror-f2XyNq9l.js";import"./vue3-lazy-LYe7IwOc.js";import"./axios-9BcR6lUQ.js";const W=R(l({__name:"Waterfall",props:{data:{},itemWidth:{}},setup(a){const e=a,t=s(e,"data"),l=i(null);let g=null;const f=i(10),j=i(0),w=r((()=>1===_.value?j.value-2*f.value:e.itemWidth)),_=r((()=>Math.floor(j.value/(e.itemWidth+2*f.value)))),y=r((()=>t.value.map((a=>(a.height=Math.ceil(w.value/a.width*a.height),a.width=w.value,a))))),x=i([]);let b;const k=a=>{b&&clearTimeout(b),b=setTimeout((()=>{for(const e of a){const{width:a}=e.contentRect;j.value=a}}),200)};return o([j,y],(()=>{t.value&&(()=>{const a=new Array(_.value).fill({}).map((()=>({height:0,waterfallDatas:[]})));let e=0;y.value.forEach((t=>{a[e]&&(a[e].waterfallDatas.push(t),a[e].height=a[e].height+t.height,e=(a=>{let e=0;for(let t=0;t<a.length-1;t++)a[e].height>a[t+1].height&&(e=t+1);return e})(a))})),x.value=a})()})),u((()=>{l.value&&(g=new ResizeObserver(k),g.observe(l.value))})),m((()=>{g&&g.disconnect})),(a,e)=>(n(),p("div",{class:"img-wall",ref_key:"imgWall",ref:l},[(n(!0),p(v,null,d(x.value,((e,t)=>(n(),p("div",{class:"img-list",key:t,style:h({width:`${w.value}px`,margin:`0 ${f.value}px`})},[c(a.$slots,"waterfill",{data:e.waterfallDatas},void 0,!0)],4)))),128))],512))}}),[["__scopeId","data-v-b10c3a86"]]),$={class:"container"},A=["onClick"],T={alt:""},z=R(l({__name:"GalleryRes",setup(l){const s=D(),o=i(),u=r((()=>{var a;return(null==(a=o.value)?void 0:a.imageRes)?o.value.imageRes.map((a=>({width:a.width,height:a.height,data:{url:a.url,orders:a.orders}}))):[]}));g((()=>{e({id:s.params.id}).then((a=>{o.value=a}))}));const m=r((()=>{var a;return(null==(a=o.value)?void 0:a.imageRes)?o.value.imageRes.map((a=>a.url)):[]})),c=i(!1),R=i(0),z=a=>{!c.value&&null!=a&&a>=0?(R.value=a,c.value=!0):c.value=!1};return(e,l)=>{const s=a,i=f("lazy");return n(),j(t,null,{default:w((()=>[_("div",$,[y(W,{data:u.value,"item-width":200},{waterfill:w((a=>[(n(!0),p(v,null,d(a.data,((a,e)=>(n(),p("div",{class:"waterfall-image",key:e,onClick:e=>z(a.data.orders),style:h({width:`${a.width}px`,height:`${a.height}px`,"margin-bottom":"10px"})},[b(_("img",T,null,512),[[i,k(M)+a.data.url]])],12,A)))),128))])),_:1},8,["data"]),c.value?(n(),j(s,{key:0,onClose:z,"initial-index":R.value,"url-list":m.value},null,8,["initial-index","url-list"])):x("",!0)])])),_:1})}}}),[["__scopeId","data-v-4ef016eb"]]);export{z as default};
